generator client {
  provider = "prisma-client"
  output   = "../lib/prisma"
}

datasource db {
  provider = "postgresql"
}

enum InstallationTargetType {
  User
}

model Installation {
  id           Int                    @id
  target_id    Int
  target_type  InstallationTargetType
  target_login String

  repositories RepositoriesOnInstallations[]
}

model Repository {
  owner            String
  name             String
  issueCount       Int    @default(0)
  pullRequestCount Int    @default(0)

  installations RepositoriesOnInstallations[]

  @@id([owner, name], name: "fullName")
}

model RepositoriesOnInstallations {
  installation   Installation @relation(fields: [installationId], references: [id], onDelete: Cascade)
  installationId Int

  repository      Repository @relation(fields: [repositoryOwner, repositoryName], references: [owner, name], onDelete: Cascade)
  repositoryOwner String
  repositoryName  String

  @@id([installationId, repositoryOwner, repositoryName])
}
